import streamlit as st
import pandas as pd
import random

# --- í˜ì´ì§€ ì„¤ì • ---
st.set_page_config(
    page_title="ì½˜í…ì¸  ê¸°ë‘¥ ì „ëµ ì‹œìŠ¤í…œ",
    page_icon="ğŸ›ï¸",
    layout="wide"
)

# --- ì „ë¬¸ê°€ ë°ì´í„°ë² ì´ìŠ¤ (ì½˜í…ì¸  ê¸°ë‘¥ ë°©ë²•ë¡  ê¸°ë°˜) ---
# ì‹œì¤‘ ì½”ì¹­ í”„ë¡œê·¸ë¨(Hootsuite, Evercoach)ì˜ í•µì‹¬ ì „ëµì„ ë¶„ì„í•˜ì—¬ êµ¬ì„±

# 1. ì½˜í…ì¸  í¬ë§· í…œí”Œë¦¿
CONTENT_FORMATS = [
    "ë¦´ìŠ¤: 15ì´ˆ ë°ëª¨",
    "ì¹´ë“œë‰´ìŠ¤: ì¸í¬ê·¸ë˜í”½",
    "í¬ìŠ¤íŠ¸: ì‹œë¦¬ì¦ˆ ê¸€",
    "ìŠ¤í† ë¦¬: Q&A/íˆ¬í‘œ"
]

# 2. ë°”ì´ëŸ´ ì•µê¸€ í…œí”Œë¦¿ (ì¡°íšŒìˆ˜ 50ë§Œ+ í¬í…ì…œ)
VIRAL_ANGLES = {
    "ë³€ì‹  íŒ": [
        "'Before & After' ê·¹ì ì¸ ë³€í™” ê³¼ì • ê³µê°œ",
        "ì´ˆë³´ìê°€ ê°€ì¥ ë§ì´ í•˜ëŠ” ì‹¤ìˆ˜ Top 3",
        "ë‹¨ 1ê°€ì§€ êµì •ìœ¼ë¡œ ì–»ëŠ” ë†€ë¼ìš´ íš¨ê³¼",
        "ì‹œê°„/ë¹„ìš©ì„ 1/10ë¡œ ì¤„ì´ëŠ” ì¹˜íŠ¸í‚¤"
    ],
    "ë‚˜ì˜ ì—¬ì •": [
        "ê°€ì¥ í˜ë“¤ì—ˆë˜ ìˆœê°„ê³¼ ê·¹ë³µê¸° (ì·¨ì•½ì  ê³ ë°±)",
        "ìˆ˜ë°±ë§Œ ì› ì“°ê³  ê¹¨ë‹¬ì€ ì§„ì§œ ë…¸í•˜ìš°",
        "ë‚˜ì˜ ë¶€ë„ëŸ¬ìš´ ì‹¤íŒ¨ë‹´ ìµœì´ˆ ê³µê°œ",
        "í‰ë²”í–ˆë˜ ë‚´ê°€ ì „ë¬¸ê°€ê°€ ë˜ê¸°ê¹Œì§€ì˜ ê³¼ì •"
    ],
    "ì•¡ì…˜ ì±Œë¦°ì§€": [
        "í•¨ê»˜í•˜ëŠ” '7ì¼ ì±Œë¦°ì§€' ì‹œì‘ ê³µì§€",
        "ë¯¸ì…˜ ì°¸ì—¬ ë…ë ¤ ë° ì¤‘ê°„ ì ê²€",
        "ì±Œë¦°ì§€ ì„±ê³µ ì‹œ ì–»ê²Œ ë  ë³´ìƒ ê³µê°œ",
        "ì°¸ê°€ìë“¤ì˜ ë†€ë¼ìš´ ì„±ê³µ ì‚¬ë¡€ ê³µìœ "
    ]
}

# --- í•¨ìˆ˜ ì •ì˜ ---
def generate_mindmap_ideas(pillar_name, pillar_type):
    """ì½˜í…ì¸  ê¸°ë‘¥ë³„ë¡œ 20ê°œì˜ ë§ˆì¸ë“œë§µ ì•„ì´ë””ì–´ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜"""
    if not pillar_name or not pillar_type:
        return []
        
    ideas = []
    angles = VIRAL_ANGLES.get(pillar_type, VIRAL_ANGLES["ë³€ì‹  íŒ"]) # ê¸°ë³¸ê°’ ì„¤ì •
    
    for _ in range(20):
        # ë‹¤ì–‘í•œ í¬ë§·ê³¼ ì•µê¸€ì„ ì¡°í•©í•˜ì—¬ ì•„ì´ë””ì–´ ìƒì„±
        content_format = random.choice(CONTENT_FORMATS)
        angle = random.choice(angles)
        idea_text = f"{content_format} - '{pillar_name}' ê´€ë ¨ {angle}"
        # Hootsuite BGM ì¶”ì²œê³¼ ê°™ì€ ë¶€ê°€ ì •ë³´ ì¶”ê°€
        if "ë¦´ìŠ¤" in content_format or "ìŠ¤í† ë¦¬" in content_format:
            idea_text += " (Tip: ì¸ê¸° BGM í™œìš©)"
        ideas.append(idea_text)
    return ideas

# --- Streamlit UI ---
st.title("ğŸ›ï¸ ì½˜í…ì¸  ê¸°ë‘¥ ê¸°ë°˜ ì „ëµ ì‹œìŠ¤í…œ (v4.0)")
st.info("**ì‹œì¤‘ ìœ ë£Œ ì½”ì¹­ì˜ í•µì‹¬ ë°©ë²•ë¡ ì„ ë‹´ì•˜ìŠµë‹ˆë‹¤. 3ê°œì˜ 'ì½˜í…ì¸  ê¸°ë‘¥'ì„ ì •ì˜í•˜ì—¬, ë‹¹ì‹ ë§Œì˜ ê°•ë ¥í•œ ì½˜í…ì¸  ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ì„¸ìš”.**")

with st.form("pillar_form"):
    st.header("Step 1: ë‹¹ì‹ ì˜ í•µì‹¬ ì½˜í…ì¸  ê¸°ë‘¥(Pillar) ì •ì˜")
    
    col1, col2 = st.columns(2)
    with col1:
        pillar1_name = st.text_input("1. ì²« ë²ˆì§¸ ì½˜í…ì¸  ê¸°ë‘¥ì˜ ì£¼ì œëŠ” ë¬´ì—‡ì¸ê°€ìš”?", placeholder="ì˜ˆ: ë±ƒì‚´ ë‹¤ì´ì–´íŠ¸")
        pillar2_name = st.text_input("2. ë‘ ë²ˆì§¸ ì½˜í…ì¸  ê¸°ë‘¥ì˜ ì£¼ì œëŠ” ë¬´ì—‡ì¸ê°€ìš”?", placeholder="ì˜ˆ: ê±´ê°•í•œ ì‹ë‹¨")
        pillar3_name = st.text_input("3. ì„¸ ë²ˆì§¸ ì½˜í…ì¸  ê¸°ë‘¥ì˜ ì£¼ì œëŠ” ë¬´ì—‡ì¸ê°€ìš”?", placeholder="ì˜ˆ: í™ˆíŠ¸ë ˆì´ë‹ ì±Œë¦°ì§€")
    with col2:
        pillar1_type = st.selectbox("ê¸°ë‘¥ 1ì˜ ì„±ê²© ì„ íƒ", options=VIRAL_ANGLES.keys(), key="p1_type", help="ì–´ë–¤ ì¢…ë¥˜ì˜ ì´ì•¼ê¸°ë¥¼ ì£¼ë¡œ ë‹¤ë£°ì§€ ì„ íƒí•˜ì„¸ìš”.")
        pillar2_type = st.selectbox("ê¸°ë‘¥ 2ì˜ ì„±ê²© ì„ íƒ", options=VIRAL_ANGLES.keys(), key="p2_type")
        pillar3_type = st.selectbox("ê¸°ë‘¥ 3ì˜ ì„±ê²© ì„ íƒ", options=VIRAL_ANGLES.keys(), key="p3_type")

    submit_button = st.form_submit_button("ğŸš€ ì½˜í…ì¸  ì‹œìŠ¤í…œ êµ¬ì¶•")

if submit_button:
    if not all([pillar1_name, pillar2_name, pillar3_name]):
        st.error("ğŸš¨ 3ê°œì˜ ì½˜í…ì¸  ê¸°ë‘¥ ì£¼ì œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.")
    else:
        st.success("ğŸ“ˆ ì‹œìŠ¤í…œ êµ¬ì¶•ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì•„ë˜ì—ì„œ ë‹¹ì‹ ì˜ ê°•ë ¥í•œ ì½˜í…ì¸  ìì‚°ì„ í™•ì¸í•˜ì„¸ìš”.")
        st.markdown("---")

        pillars = {
            pillar1_name: pillar1_type,
            pillar2_name: pillar2_type,
            pillar3_name: pillar3_type
        }

        # 1. ë§ˆì¸ë“œë§µ ì•„ì´ë””ì–´ ìƒì„± ë° ì¶œë ¥
        st.header("ğŸ§  50ë§Œ ì¡°íšŒìˆ˜ í¬í…ì…œ, ì½˜í…ì¸  ì•„ì´ë””ì–´ ë§ˆì¸ë“œë§µ (ì´ 60ê°œ)")
        
        for pillar_name, pillar_type in pillars.items():
            with st.expander(f"**ê¸°ë‘¥: {pillar_name} (ì„±ê²©: {pillar_type}) - ì•„ì´ë””ì–´ 20ê°œ í¼ì³ë³´ê¸°**"):
                ideas = generate_mindmap_ideas(pillar_name, pillar_type)
                if ideas:
                    # ë³´ê¸° ì¢‹ê²Œ 2ì—´ë¡œ í‘œì‹œ
                    col1, col2 = st.columns(2)
                    for i, idea in enumerate(ideas):
                        if i < 10:
                            col1.write(f"ğŸ’¡ Idea {i+1}: {idea}")
                        else:
                            col2.write(f"ğŸ’¡ Idea {i+1}: {idea}")
                else:
                    st.write("ì•„ì´ë””ì–´ë¥¼ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë‘¥ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")
        
        st.markdown("---")

        # 2. ì£¼ê°„ ì½˜í…ì¸  ìº˜ë¦°ë” ìƒì„±
        st.header("ğŸ—“ï¸ ì „ëµì  ì£¼ê°„ ì½˜í…ì¸  ìº˜ë¦°ë”")
        st.write("**'ì´ˆê¸°-ì¤‘ê¸°-ìˆ˜ìµí™”' ë‹¨ê³„ë¥¼ ê³ ë ¤í•˜ì—¬ ì½˜í…ì¸ ë¥¼ ì „ëµì ìœ¼ë¡œ ë°°ë¶„í•œ Hootsuite ìŠ¤íƒ€ì¼ í…œí”Œë¦¿ì…ë‹ˆë‹¤.**")

        calendar_data = {
            "ìš”ì¼": ["ì›”ìš”ì¼", "í™”ìš”ì¼", "ìˆ˜ìš”ì¼", "ëª©ìš”ì¼", "ê¸ˆìš”ì¼", "í† ìš”ì¼"],
            "ì½˜í…ì¸  ê¸°ë‘¥": [
                pillar1_name, 
                pillar2_name, 
                pillar1_name, 
                pillar3_name,
                pillar2_name,
                pillar3_name,
            ],
            "ì½˜í…ì¸  í¬ë§·": ["ë¦´ìŠ¤", "ì¹´ë“œë‰´ìŠ¤", "ìŠ¤í† ë¦¬", "ë¦´ìŠ¤", "í¬ìŠ¤íŠ¸", "ìŠ¤í† ë¦¬(CTA)"],
            "ì „ëµì  ëª©í‘œ": [
                "**ì´ˆì°½ê¸°:** ê¸°ë³¸ íŒìœ¼ë¡œ ì‹ ê·œ íŒ”ë¡œì›Œ ìœ ì…", 
                "**ì´ˆì°½ê¸°:** ì •ë³´ì„± ì½˜í…ì¸ ë¡œ ì „ë¬¸ì„± ê°ì¸", 
                "**ì¤‘ê°„:** ì†Œí†µ/Q&Aë¡œ ì»¤ë®¤ë‹ˆí‹° í™œì„±í™”", 
                "**ì¤‘ê°„:** ì±Œë¦°ì§€ë¡œ ì°¸ì—¬ ë° ë°”ì´ëŸ´ ìœ ë„",
                "**ìˆ˜ìµí™”:** ê³ ê° ì„±ê³µì‚¬ë¡€ë¡œ ì‹ ë¢°ë„ ì¦í­",
                "**ìˆ˜ìµí™”:** ì œí’ˆ/ì„œë¹„ìŠ¤ êµ¬ë§¤ ì „í™˜ (ê°•ë ¥í•œ CTA)"
            ]
        }
        df = pd.DataFrame(calendar_data)
        st.table(df)
        
        st.info("""
        **ğŸ’¡ ìº˜ë¦°ë” í™œìš©ë²•:**
        - **ì›”/í™”:** ìƒˆë¡œìš´ ì ì¬ê³ ê°ì„ ëŒì–´ë“¤ì´ëŠ” ë° ì§‘ì¤‘í•˜ì„¸ìš”. (ë„“ì€ ì£¼ì œ, ì‰¬ìš´ íŒ)
        - **ìˆ˜/ëª©:** ê¸°ì¡´ íŒ”ë¡œì›Œì˜ ì°¸ì—¬ë¥¼ ìœ ë„í•˜ê³  ê´€ê³„ë¥¼ ê¹Šê²Œ ë§Œë“œì„¸ìš”. (ì±Œë¦°ì§€, ì†Œí†µ)
        - **ê¸ˆ/í† :** êµ¬ì¶•ëœ ì‹ ë¢°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ìˆ˜ìµ ì°½ì¶œ ê¸°íšŒë¥¼ ë§Œë“œì„¸ìš”. (ì£¼ë§ í”„ë¡œëª¨ì…˜)
        """)
